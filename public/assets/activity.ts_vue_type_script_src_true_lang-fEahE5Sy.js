import{u as L}from"./useQuery-Vqq1gs7x.js";import{u as Q}from"./useMutation-S9Yn_XDd.js";import{G as d,d as j,x as D,p as I,N as K,Q as n,S as M,T as c}from"./index-Cd84-U9l.js";import{C as R,u as T}from"./CustomInput-aZRchFnw.js";import{f as U}from"./dateUtils-CyrnVGE1.js";const V=async a=>{if(a===void 0||isNaN(a))return{id:0,descripcion:"",id_instructor:"",cupo:0,fecha:"",fecha_inicio:"",fecha_fin:""};try{const{data:t}=await d.get(`/actividades/${a}`);return t}catch(t){throw console.log("Error inesperado:",t),new Error("No se pudo realizar la petición")}},k=async a=>{const t=a.id;return t&&t>0?await B(t,a):await H(a)},B=async(a,t)=>{try{const{data:o}=await d.patch(`/actividades/editar/${a}`,t);return o}catch{throw new Error("No se pudo realizar la petición")}},H=async a=>{try{const{data:t}=await d.post("/actividades/registrar",a);return t}catch(t){throw console.log("Error inesperado:",t),new Error("No se pudo realizar la petición")}},J=M({descripcion:c().required(),id_instructor:c().required(),cupo:c().required(),fecha:c(),hora_inicio:c(),hora_fin:c()}),Z=j({components:{CustomInput:R},props:{idActivity:{type:Number,required:!1}},setup(a){const t=D(),o=I(""),{data:s,isError:f,isLoading:m,refetch:l}=L({queryKey:["activity",a.idActivity],queryFn:()=>V(Number(a.idActivity)),retry:!1}),{mutate:h,isSuccess:v,data:u}=Q({mutationFn:k}),{values:y,errors:A,defineField:e,resetForm:p,handleSubmit:_}=T({validationSchema:J}),[w,N]=e("descripcion"),[E,q]=e("id_instructor"),[S,g]=e("fecha"),[F,$]=e("cupo"),[b,z]=e("hora_inicio"),[C,x]=e("hora_fin"),G=_(async r=>{const i={...r,fecha:U(r.fecha)};h(i)});return K(()=>{f.value&&!m.value&&t.replace("/admin/administrarActividades/lista-actividades")}),n(s,()=>{var r,i;!s.value||!((r=s.value)!=null&&r.data)||p({values:(i=s.value)==null?void 0:i.data})},{deep:!0,immediate:!0}),n(v,r=>{var i;r&&(o.value="La actividad se ha actualizado correctamente",t.replace(`/admin/administrarActividades/lista-actividades/${(i=u.value.data)==null?void 0:i.id}`),p({values:u.value}))}),n(()=>a.idActivity,()=>{l()}),{values:y,mensaje:o,errors:A,descripcion:w,descripcionAttrs:N,id_instructor:E,id_instructorAttrs:q,fecha:S,fechaAttrs:g,cupo:F,cupoAttrs:$,hora_inicio:b,hora_inicioAttrs:z,hora_fin:C,hora_finAttrs:x,onSubmit:G}}});export{Z as _};
