import{G as u,O as I,d as N,x as O,p as Q,N as U,Q as c,S as j,T as l,bx as n}from"./index-Cd84-U9l.js";import{C as K,u as L}from"./CustomInput-aZRchFnw.js";import{u as R}from"./useQuery-Vqq1gs7x.js";import{u as T}from"./useMutation-S9Yn_XDd.js";const k=async r=>{if(r===void 0)return{id:"",tipo:"",descripcion:"",precio:"",dias_duracion:"",mes_duracion:""};try{const{data:e}=await u.get(`/membresias/${r}`);return e}catch(e){if(I(e))return!1;throw console.log("Ocurrio un error",e),new Error("No se pudo realizar la peticion")}},B=async r=>{const e=r.id;return e&&e!==""?await D(e,r):await H(r)},D=async(r,e)=>{try{const{data:t}=await u.patch(`/membresias/editar/${r}`,e);return t}catch{throw new Error("Error updating membership")}},H=async r=>{try{const{data:e}=await u.post("/membresias/crear-membresia",r);return e}catch{throw new Error("Error creating membership")}},J=j({tipo:l().required(),descripcion:l().required(),precio:n().integer().required(),dias_duracion:n().integer().required(),mes_duracion:n().integer().required()}),Y=N({components:{CustomInput:K},props:{idMembresia:{type:String,required:!0}},setup(r){const e=O(),t=Q(""),{data:o,isError:b,isLoading:h,refetch:f}=R({queryKey:["membership",r.idMembresia],queryFn:()=>k(r.idMembresia),retry:!1}),{mutate:y,isSuccess:v,data:d}=T({mutationFn:B}),{values:w,defineField:i,errors:_,resetForm:m,handleSubmit:M}=L({validationSchema:J}),[g,q]=i("tipo"),[A,E]=i("descripcion"),[S,$]=i("precio"),[F,x]=i("dias_duracion"),[C,z]=i("mes_duracion"),G=M(async a=>{y(a)});return U(()=>{b.value&&!h.value&&e.replace("/admin/membresias/lista-membresias")}),c(o,()=>{var a,s;!o.value||!((a=o.value)!=null&&a.data)||m({values:(s=o.value)==null?void 0:s.data})},{deep:!0,immediate:!0}),c(v,a=>{var s,p;a&&(t.value="Membresia actualizada correctamente",e.replace(`/admin/membresias/lista-membresias/${(p=(s=d.value.data)==null?void 0:s.data)==null?void 0:p.id}`),m({values:d.value}))}),c(()=>r.idMembresia,()=>{f()}),{values:w,errors:_,mensaje:t,tipo:g,tipoAttrs:q,descripcion:A,descripcionAttrs:E,precio:S,precioAttrs:$,dias_duracion:F,dias_duracionAttrs:x,mes_duracion:C,mes_duracionAttrs:z,onSubmit:G}}});export{Y as _};
